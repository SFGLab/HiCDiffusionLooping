BootStrap: library
From: ubuntu:22.04

%post
    apt-get update && \
        apt-get install -y \
            wget \
            git \
            vim \
            tabix \
            ghostscript \
            pkg-config \
            autoconf \
            automake \
            locales \
            make \
            gcc \
            g++ \
            perl \
            python3 \
            bedtools \
            libxml-simple-perl \
            libxml-dom-xpath-perl \
            zlib1g-dev \
            libbz2-dev \
            liblzma-dev \
            libcurl4-gnutls-dev \
            libssl-dev \
            libperl-dev \
            libgsl0-dev \
        && \
        apt-get clean && \
        rm -rf /var/lib/apt/lists/*

    export DEBIAN_FRONTEND=noninteractive
    export LANGUAGE=en_US.UTF-8
    export LC_ALL=en_US.UTF-8
    export LANG=en_US.UTF-8
    export LC_CTYPE=en_US.UTF-8
    locale-gen $LANG
    dpkg-reconfigure locales
        
    cd /opt
    git clone https://github.com/vcftools/vcftools.git
    cd vcftools
    ./autogen.sh
    ./configure
    make
    make install

    cd /opt
	git clone --recurse-submodules https://github.com/samtools/htslib.git
    git clone https://github.com/samtools/bcftools.git
    cd bcftools
    make
    ln -s $(pwd)/bcftools /bin/bcftools

    cd /opt
    wget https://meme-suite.org/meme/meme-software/5.5.5/meme-5.5.5.tar.gz
    tar zxf meme-5.5.5.tar.gz
    cd meme-5.5.5
    ./configure --prefix=/opt/meme # --enable-build-libxml2 --enable-build-libxslt
    make
    # make test || cat tests/scripts/test-suite.log
    make install
    cd ..
    rm -rf meme-5.5.5 meme-5.5.5.tar.gz


%runscript
    exec "$@"

%environment
    export LANGUAGE=en_US.UTF-8
    export LC_ALL=en_US.UTF-8
    export LANG=en_US.UTF-8
    export LC_CTYPE=en_US.UTF-8
    export PATH=/opt/vcftools/src/perl:$PATH
    export PATH=/opt/meme/bin:/opt/meme/libexec/meme-5.5.5:$PATH